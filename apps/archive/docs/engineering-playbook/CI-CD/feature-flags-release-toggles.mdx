---
title: Feature Flags - Release Toggles
---

# Feature Flags: Release Toggles

Release Toggles are a fundamental type of feature flag primarily used to enable trunk-based development and continuous delivery practices. 
They provide teams with the ability to deploy incomplete or untested code to production in a dormant state, and give product managers 
flexibility in controlling feature visibility.

These toggles are characterized by their relatively short lifespan, typically lasting only days to weeks, and their deployment-based 
change pattern. When a release toggle configuration changes, it affects all users consistently through a new deployment, rather 
than varying per-request.

Basically, a release toggle is a simple and good way for a team to start using feature flags and continuous delivery practices.

Let's explore the key aspects of Release Toggles and how they support modern development practices.

**Abilities:**
- Used to **enable trunk-based** development for teams practicing **Continuous Delivery**. 
- Allow incomplete and un-tested codepaths to be shipped to production as **latent code** which may never be turned on.
- Allow product-managers to **not show a partly or fully ready feature to end users** (for many reasons).

**Characteristics:**
- **Loves form Days to Weeks** - generally not stick around much longer than a week or two (although product-centric toggles may need to remain in place for a 
longer period).
- **Changes with deployment** - every toggling decision for a given release version will be the same, and changing that toggling decision by 
rolling out a new release with a toggle configuration change is usually perfectly acceptable.

## Implementing a Release toggles

Создание релиз тоглов занимает очень мало времени. Для этого нам понадобяться следующие компоненты:
1. `ReleaseTogglesEnum`, `ENVS`, `ENV_NAME` environment variable with current env name from `ENV_NAMES`  - перечисление всех тоглов в системе, cписок уникальных строк,
которые будут использоваться для идентификации тоглов в файле конфигурации и для получения значения тоглов в коде. Так же нам понадобится перечисление всех 
енвов, в которых будут использоваться тоглы, и сама енв переменная, которая будет содержать имя текущего енва.
2. `RELEASE_TOGGLES_CONFIG` (static configuration) - файл с конфигурацией тоглов, который по ключу тогла будет содержать его значение (булевый тип) для каждого енва.
3. `featureTogglesAPI` - API для получения значения тоглов в коде по их ключу и для валидации.

![Release Toggles Implementation](/img/feate-toggles-implementation.png)

На рисунке выше изображена схема реализации релиз тоглов в приложении. `ReleaseTogglesEnum` и `ENVS` мы используем для создания `RELEASE_TOGGLES_CONFIG`.
Этот конфиг, в свою очередь, используется в `featureTogglesAPI` для получения значения тоглов в коде по их ключу и для валидации. Соответственно, `featureTogglesAPI`
так же должен получать ключ тогла с `ReleaseTogglesEnum` и ключ енва с `ENVS`.

Дальше вы увидите примеры кода для создания и использования тоглов.

List app environments:

```typescript
const ENVS = ['dev', 'qa', 'prod'] as const;
```

Use env variable name to get the current environment (vite example). You can use NODE_ENV or set your own variable:

```typescript
const ENVS = ['dev', 'qa', 'prod'] as const;

const ENV_NAME = import.meta.env.VITE_ENV_NAME;
```

List feature toggles:

```typescript
const ReleaseTogglesEnum {
  Feature1 = 'feature1',
  Feature2 = 'feature2',
};
```

Define feature toggles configuration:

```typescript
const RELEASE_TOGGLES_CONFIG = {
  [ReleaseTogglesEnum.Feature1]: {
    meta: {
      description: 'Feature 1',
      createdAt: '2023-01-01',
      createdBy: 'John Doe'
    },
    enabled: {
      dev: true,
      qa: false,
      prod: false
    },
  },
  [ReleaseTogglesEnum.Feature2]: {
    meta: {
      description: 'Feature 2',
      createdAt: '2023-01-02',
      createdBy: 'Jane Doe'
    },
    enabled: {
      dev: false,
      qa: false,
      prod: true
    },
    value: {
      dev: 'value4',
      qa: 'value5',
      prod: 'value6'
    }
  }
} as const;
```

Create feature toggles:

```typescript
import { createFeatureToggles } from '@runespoorstack/feature-toggles-imperative';

const featureTogglesAPI = createFeatureToggles({
  featureToggles: RELEASE_TOGGLES_CONFIG,
  envs: ENVS,
  env: ENV_NAME
});
```

Use feature toggles:

```typescript
const feature1 = featureTogglesAPI.getFeatureToggle(ReleaseTogglesEnum.Feature1);
console.log(feature1);
// {
//   meta: {
//     description: 'Feature 1',
//     createdAt: '2023-01-01',
//     createdBy: 'John Doe'
//   },
//   enabled: true,
//   value: 'value6'
// }
```

## Mistakes in using release toggles

### 1. Using not descriptive toggle names

### 2. Not using meta information

### 3. Not covering Toggle Router with tests

### 4. Forgetting to get rid of unused toggles

### 5. Not exposing current feature toggle configuration










